!function(){function e(t,o,n){function a(r,i){if(!o[r]){if(!t[r]){var s="function"==typeof require&&require;if(!i&&s)return s(r,!0);if(l)return l(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var c=o[r]={exports:{}};t[r][0].call(c.exports,function(e){return a(t[r][1][e]||e)},c,c.exports,e,t,o,n)}return o[r].exports}for(var l="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}return e}()({1:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e}Object.defineProperty(o,"__esModule",{value:!0}),o["default"]=undefined;var r=e("./util"),i=function(){function e(t){n(this,e),this._layers={},this._group=t}return l(e,[{key:"add",value:function(e,t){null!=t&&(this._layers[t]&&this._group.removeLayer(this._layers[t]),this._layers[t]=e),this._group.addLayer(e)}},{key:"remove",value:function(e){if(null!=e){e=(0,r.asArray)(e);for(var t=0;t<e.length;t++)this._layers[e[t]]&&(this._group.removeLayer(this._layers[e[t]]),delete this._layers[e[t]])}}},{key:"clear",value:function(){this._layers={},this._group.clearLayers()}}]),e}();o["default"]=i},{"./util":17}],2:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(t){n(this,e),this._controlsNoId=[],this._controlsById={},this._map=t}return l(e,[{key:"add",value:function(e,t){null!=t?(this._controlsById[t]&&this._map.removeControl(this._controlsById[t]),this._controlsById[t]=e):this._controlsNoId.push(e),this._map.addControl(e)}},{key:"get",value:function(e){var t=null;return this._controlsById[e]&&(t=this._controlsById[e]),t}},{key:"remove",value:function(e){if(this._controlsById[e]){var t=this._controlsById[e];this._map.removeControl(t),delete this._controlsById[e]}}},{key:"clear",value:function(){for(var e=0;e<this._controlsNoId.length;e++){var t=this._controlsNoId[e];this._map.removeControl(t)}for(var o in this._controlsNoId=[],this._controlsById){var n=this._controlsById[o];this._map.removeControl(n)}this._controlsById={}}}]),e}();o["default"]=r},{}],3:[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e){var t=l["default"].CRS.EPSG3857;switch(e.crsClass){case"L.CRS.EPSG3857":t=l["default"].CRS.EPSG3857;break;case"L.CRS.EPSG4326":t=l["default"].CRS.EPSG4326;break;case"L.CRS.EPSG3395":t=l["default"].CRS.EPSG3395;break;case"L.CRS.Simple":t=l["default"].CRS.Simple;break;case"L.Proj.CRS":e.options&&e.options.bounds&&(e.options.bounds=l["default"].bounds(e.options.bounds)),e.options&&e.options.transformation&&(e.options.transformation=new l["default"].Transformation(e.options.transformation[0],e.options.transformation[1],e.options.transformation[2],e.options.transformation[3])),t=new r["default"].CRS(e.code,e.proj4def,e.options);break;case"L.Proj.CRS.TMS":e.options&&e.options.bounds&&(e.options.bounds=l["default"].bounds(e.options.bounds)),e.options&&e.options.transformation&&(e.options.transformation=l["default"].Transformation(e.options.transformation[0],e.options.transformation[1],e.options.transformation[2],e.options.transformation[3])),t=new r["default"].CRS(e.code,e.proj4def,e.options)}return t}Object.defineProperty(o,"__esModule",{value:!0}),o.getCRS=a;var l=n(e("./global/leaflet")),r=n(e("./global/proj4leaflet"))},{"./global/leaflet":10,"./global/proj4leaflet":11}],4:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e}Object.defineProperty(o,"__esModule",{value:!0}),o["default"]=undefined;var r=e("./util"),i=function(){function e(){n(this,e),this.columns=[],this.colnames=[],this.colstrict=[],this.effectiveLength=0,this.colindices={}}return l(e,[{key:"_updateCachedProperties",value:function(){var e=this;this.effectiveLength=0,this.colindices={},this.columns.forEach(function(t,o){e.effectiveLength=Math.max(e.effectiveLength,t.length),e.colindices[e.colnames[o]]=o})}},{key:"_colIndex",value:function(e){var t=this.colindices[e];return void 0===t?-1:t}},{key:"col",value:function(e,t,o){if("string"!=typeof e)throw new Error('Invalid column name "'+e+'"');var n=this._colIndex(e);return 1===arguments.length?n<0?null:(0,r.recycle)(this.columns[n],this.effectiveLength):(n<0&&(n=this.colnames.length,this.colnames.push(e)),this.columns[n]=(0,r.asArray)(t),this.colstrict[n]=!!o,this._updateCachedProperties(),this)}},{key:"cbind",value:function(e){var t=this;return Object.keys(e).forEach(function(o){var n=e[o];t.col(o,n)}),this}},{key:"get",value:function(e,t,o){var n=this;if(e>this.effectiveLength)throw new Error("Row argument was out of bounds: "+e+" > "+this.effectiveLength);var a=-1;if(void 0===t){var l={};return this.colnames.forEach(function(t,o){l[t]=n.columns[o][e%n.columns[o].length]}),l}if("string"==typeof t?a=this._colIndex(t):"number"==typeof t&&(a=t),a<0||a>this.columns.length){if(o)return;throw new Error("Unknown column index: "+t)}return this.columns[a][e%this.columns[a].length]}},{key:"nrow",value:function(){return this.effectiveLength}}]),e}();o["default"]=i},{"./util":17}],5:[function(e){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}var o=t(e("./global/leaflet"));"undefined"==typeof o["default"].Icon.Default.imagePath&&(o["default"].Icon.Default.imagePath="https://unpkg.com/leaflet@1.3.1/dist/images/")},{"./global/leaflet":10}],6:[function(e){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}var o=t(e("./global/leaflet"));o["default"].Tooltip.prototype.options.textsize="10px",o["default"].Tooltip.prototype.options.textOnly=!1,o["default"].Tooltip.prototype.options.style=null;var n=o["default"].Tooltip.prototype._initLayout;o["default"].Tooltip.prototype._initLayout=function(){if(n.call(this),this._container.style.fontSize=this.options.textsize,this.options.textOnly&&o["default"].DomUtil.addClass(this._container,"leaflet-tooltip-text-only"),this.options.style)for(var e in this.options.style)this._container.style[e]=this.options.style[e]}},{"./global/leaflet":10}],7:[function(e){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}var o=t(e("./global/leaflet")),n=/^\/\//,a=function(e){return n.test(e)&&"file:"===window.location.protocol&&(e="http:"+e),e},l=o["default"].TileLayer.prototype.initialize;o["default"].TileLayer.prototype.initialize=function(e,t){e=a(e),l.call(this,e,t)};var r=o["default"].TileLayer.WMS.prototype.initialize;o["default"].TileLayer.WMS.prototype.initialize=function(e,t){e=a(e),r.call(this,e,t)}},{"./global/leaflet":10}],8:[function(e,t,o){(function(e){(function(){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o["default"]=e.HTMLWidgets}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,o){(function(e){(function(){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o["default"]=e.jQuery}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(e,t,o){(function(e){(function(){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o["default"]=e.L}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(e,t,o){(function(e){(function(){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o["default"]=e.L.Proj}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],12:[function(e,t,o){(function(e){(function(){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o["default"]=e.Shiny}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(e){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=e.getContainer().id,o=e.getBounds();r["default"].onInputChange(t+"_bounds",{north:o.getNorthEast().lat,east:o.getNorthEast().lng,south:o.getSouthWest().lat,west:o.getSouthWest().lng}),r["default"].onInputChange(t+"_center",{lng:e.getCenter().lng,lat:e.getCenter().lat}),r["default"].onInputChange(t+"_zoom",e.getZoom())}function n(e){var t={x:null,y:null};(0,a["default"])(document).on("mousewheel DOMMouseScroll","*",function(o){e.scrollWheelZoom.disable(),t={x:o.originalEvent.screenX,y:o.originalEvent.screenY}}),(0,a["default"])(document).on("mousemove","*",function(o){e.options.scrollWheelZoom&&(null!==t.x&&o.screenX!==t.x||o.screenY!==t.y)&&(e.scrollWheelZoom.enable(),t={x:null,y:null})}),(0,a["default"])(document).on("mousedown",".leaflet",function(){e.options.scrollWheelZoom&&(e.scrollWheelZoom.enable(),t={x:null,y:null})})}var a=t(e("./global/jquery")),l=t(e("./global/leaflet")),r=t(e("./global/shiny")),i=t(e("./global/htmlwidgets")),s=e("./util"),u=e("./crs_utils"),c=t(e("./control-store")),d=t(e("./layer-manager")),f=t(e("./methods"));e("./fixup-default-icon"),e("./fixup-default-tooltip"),e("./fixup-url-protocol");var p=t(e("./dataframe")),y=t(e("./cluster-layer-store"));window.LeafletWidget={},window.LeafletWidget.utils={};var h=window.LeafletWidget.methods=a["default"].extend({},f["default"]);window.LeafletWidget.DataFrame=p["default"],window.LeafletWidget.ClusterLayerStore=y["default"],window.LeafletWidget.utils.getCRS=u.getCRS,i["default"].widget({name:"leaflet",type:"output",factory:function(e){var t=null;return{getMap:function(){return t},renderValue:function(s){if(s&&s.options&&s.options.crs&&(s.options.crs=(0,u.getCRS)(s.options.crs)),t&&(t.remove(),t=void 0),n(t=s.options.mapFactory&&"function"==typeof s.options.mapFactory?s.options.mapFactory(e,s.options):l["default"].map(e,s.options)),t.leafletr={hasRendered:!1,pendingRenderData:null},i["default"].shinyMode&&/\bshiny-bound-output\b/.test(e.className)){t.id=e.id,(0,a["default"])(e).data("leaflet-map",t),t.on("click",function(e){r["default"].onInputChange(t.id+"_click",{lat:e.latlng.lat,lng:e.latlng.lng,".nonce":Math.random()})});var c=null;t.on("moveend",function(e){o(e.target)}).on("layeradd layerremove",function(e){t.layerManager.getGroupNameFromLayerGroup(e.layer)&&(c&&(clearTimeout(c),c=null),c=setTimeout(function(){c=null,r["default"].onInputChange(t.id+"_groups",t.layerManager.getVisibleGroups())},100))})}this.doRenderValue(s,t)},doRenderValue:function(t,n){function l(){return"always"===r.zoomToLimits||"first"===r.zoomToLimits&&!n.leafletr.hasRendered}if(0!==e.offsetWidth&&0!==e.offsetHeight){n.leafletr.pendingRenderData=null;var r=a["default"].extend({zoomToLimits:"always"},t.options);n.layerManager?(n.controls.clear(),n.layerManager.clear()):(n.controls=new c["default"](n),n.layerManager=new d["default"](n));var u=!1;if(t.setView&&(u=!0,n.setView.apply(n,t.setView)),t.fitBounds&&(u=!0,h.fitBounds.apply(n,t.fitBounds)),t.flyTo&&(u||n.leafletr.hasRendered||n.fitWorld(),u=!0,n.flyTo.apply(n,t.flyTo)),t.flyToBounds&&(u||n.leafletr.hasRendered||n.fitWorld(),u=!0,h.flyToBounds.apply(n,t.flyToBounds)),t.options.center&&(u=!0),!u&&l()&&!n.getZoom())if(t.limits&&!a["default"].isEmptyObject(t.limits)){var f=.006;t.limits.lat[0]===t.limits.lat[1]&&(t.limits.lat[0]=t.limits.lat[0]-f,t.limits.lat[1]=t.limits.lat[1]+f),t.limits.lng[0]===t.limits.lng[1]&&(t.limits.lng[0]=t.limits.lng[0]-f,t.limits.lng[1]=t.limits.lng[1]+f),n.fitBounds([[t.limits.lat[0],t.limits.lng[0]],[t.limits.lat[1],t.limits.lng[1]]])}else n.fitWorld();for(var p=0;t.calls&&p<t.calls.length;p++){var y=t.calls[p];h[y.method]?h[y.method].apply(n,y.args):(0,s.log)("Unknown method "+y.method)}n.leafletr.hasRendered=!0,i["default"].shinyMode&&setTimeout(function(){o(n)},1)}else n.leafletr.pendingRenderData=t},resize:function(){t&&(t.invalidateSize(),t.leafletr.pendingRenderData&&this.doRenderValue(t.leafletr.pendingRenderData,t))}}}}),i["default"].shinyMode&&r["default"].addCustomMessageHandler("leaflet-calls",function(e){var t=e.id,o=document.getElementById(t),n=o?(0,a["default"])(o).data("leaflet-map"):null;if(n)if(n.leafletr.hasRendered)for(var l=0;l<e.calls.length;l++){for(var i=e.calls[l],u=i.args,c=0;c<i.evals.length;c++)window.HTMLWidgets.evaluateStringMember(u,i.evals[c]);i.dependencies&&r["default"].renderDependencies(i.dependencies),h[i.method]?h[i.method].apply(n,u):(0,s.log)("Unknown method "+i.method)}else n.leafletr.pendingRenderData.calls=n.leafletr.pendingRenderData.calls.concat(e.calls);else(0,s.log)("Couldn't find map with id "+t)})},{"./cluster-layer-store":1,"./control-store":2,"./crs_utils":3,"./dataframe":4,"./fixup-default-icon":5,"./fixup-default-tooltip":6,"./fixup-url-protocol":7,"./global/htmlwidgets":8,"./global/jquery":9,"./global/leaflet":10,"./global/shiny":12,"./layer-manager":14,"./methods":15,"./util":17}],14:[function(e,t,o){(function(t){(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,o){return t&&l(e.prototype,t),o&&l(e,o),e}Object.defineProperty(o,"__esModule",{value:!0}),o["default"]=undefined;var i=n(e("./global/jquery")),s=n(e("./global/leaflet")),u=e("./util"),c=function(){function e(t){a(this,e),this._map=t,this._byGroup={},this._byCategory={},this._byLayerId={},this._byStamp={},this._byCrosstalkGroup={},this._categoryContainers={},this._groupContainers={}}return r(e,[{key:"addLayer",value:function(e,o,n,a,l,r){var i=this,u="string"==typeof n,c="string"==typeof a,d=s["default"].Util.stamp(e)+"",f=this._categoryContainers[o]=this._categoryContainers[o]||s["default"].layerGroup().addTo(this._map),p=null;if(u){var y=this._layerIdKey(o,n);(p=this._byLayerId[y])&&this._removeLayer(p),this._byLayerId[y]=e}c&&(this._byGroup[a]=this._byGroup[a]||{},this._byGroup[a][d]=e,f=this.getLayerGroup(a,!0)),this._byCategory[o]=this._byCategory[o]||{},this._byCategory[o][d]=e;var h=this._byStamp[d]={layer:e,group:a,ctGroup:l,ctKey:r,layerId:n,category:o,container:f,hidden:!1};if(l){e.setStyle&&(e.options.origOpacity="undefined"!=typeof e.options.opacity?e.options.opacity:.5,e.options.origFillOpacity="undefined"!=typeof e.options.fillOpacity?e.options.fillOpacity:.2);var g=this._byCrosstalkGroup[l];if(!g){g=this._byCrosstalkGroup[l]={};var m=t.crosstalk,v=function(e){if(e.value){for(var t={},o=0;o<e.value.length;o++)t[e.value[o]]=!0;for(var n=Object.keys(g),a=0;a<n.length;a++){var l=n[a],r=i._byStamp[g[l]];i._setVisibility(r,t[n[a]])}}else for(var s=Object.keys(g),u=0;u<s.length;u++){var c=s[u],d=i._byStamp[g[c]];i._setVisibility(d,!0)}},b=new m.FilterHandle(l);b.on("change",v);var _=function(e){if(e.value&&e.value.length){for(var t={},o=0;o<e.value.length;o++)t[e.value[o]]=!0;for(var n=Object.keys(g),a=0;a<n.length;a++){var l=n[a],r=i._byStamp[g[l]];i._setOpacity(r,t[n[a]]?1:.2)}}else for(var s=Object.keys(g),u=0;u<s.length;u++){var c=s[u],d=i._byStamp[g[c]];i._setOpacity(d,1)}},w=new m.SelectionHandle(l);w.on("change",_),setTimeout(function(){v({value:b.filteredKeys}),_({value:w.value})},100)}g[r]||(g[r]=[]),g[r].push(d)}return h.hidden||f.addLayer(e),p}},{key:"brush",value:function(e,o){var n=this;Object.keys(this._byCrosstalkGroup).forEach(function(a){var l=n._byCrosstalkGroup[a],r=[];Object.keys(l).forEach(function(t){l[t].forEach(function(o){var a=n._byStamp[o];a.layer.getLatLng&&e.contains(a.layer.getLatLng())&&r.push(t)})}),new t.crosstalk.SelectionHandle(a).set(r,o)})}},{key:"unbrush",value:function(e){Object.keys(this._byCrosstalkGroup).forEach(function(o){new t.crosstalk.SelectionHandle(o).clear(e)})}},{key:"_setVisibility",value:function(e,t){e.hidden^t||(t?(e.container.addLayer(e.layer),e.hidden=!1):(e.container.removeLayer(e.layer),e.hidden=!0))}},{key:"_setOpacity",value:function(e,t){e.layer.setOpacity?e.layer.setOpacity(t):e.layer.setStyle&&e.layer.setStyle({opacity:t*e.layer.options.origOpacity,fillOpacity:t*e.layer.options.origFillOpacity})}},{key:"getLayer",value:function(e,t){return this._byLayerId[this._layerIdKey(e,t)]}},{key:"removeLayer",value:function(e,t){var o=this;i["default"].each((0,u.asArray)(t),function(t,n){var a=o._byLayerId[o._layerIdKey(e,n)];a&&o._removeLayer(a)})}},{key:"clearLayers",value:function(e){var t=this,o=this._byCategory[e];if(!o)return!1;var n=[];i["default"].each(o,function(e){n.push(e)}),i["default"].each(n,function(e,o){t._removeLayer(o)})}},{key:"getLayerGroup",value:function(e,t){var o=this._groupContainers[e];return t&&!o&&(this._byGroup[e]=this._byGroup[e]||{},(o=this._groupContainers[e]=s["default"].featureGroup()).groupname=e,o.addTo(this._map)),o}},{key:"getGroupNameFromLayerGroup",value:function(e){return e.groupname}},{key:"getVisibleGroups",value:function(){var e=this,t=[];return i["default"].each(this._groupContainers,function(o,n){e._map.hasLayer(n)&&t.push(o)}),t}},{key:"getAllGroupNames",value:function(){var e=[];return i["default"].each(this._groupContainers,function(t){e.push(t)}),e}},{key:"clearGroup",value:function(e){var t=this,o=this._byGroup[e];if(!o)return!1;var n=[];i["default"].each(o,function(e){n.push(e)}),i["default"].each(n,function(e,o){t._removeLayer(o)})}},{key:"clear",value:function(){function e(e,t){t.clearLayers()}this._byGroup={},this._byCategory={},this._byLayerId={},this._byStamp={},this._byCrosstalkGroup={},i["default"].each(this._categoryContainers,e),this._categoryContainers={},i["default"].each(this._groupContainers,e),this._groupContainers={}}},{key:"_removeLayer",value:function(e){var t;t="string"==typeof e?e:s["default"].Util.stamp(e);var o=this._byStamp[t];if(!o)return!1;if(o.container.removeLayer(t),"string"==typeof o.group&&delete this._byGroup[o.group][t],"string"==typeof o.layerId&&delete this._byLayerId[this._layerIdKey(o.category,o.layerId)],delete this._byCategory[o.category][t],delete this._byStamp[t],o.ctGroup){var n=this._byCrosstalkGroup[o.ctGroup],a=n[o.ctKey],l=a?a.indexOf(t):-1;l>=0&&(1===a.length?delete n[o.ctKey]:a.splice(l,1))}}},{key:"_layerIdKey",value:function(e,t){return e+"\n"+t}}]),e}();o["default"]=c}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./global/jquery":9,"./global/leaflet":10,"./util":17}],15:[function(e,t,o){(function(t){(function(){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t,o,n,a){return function(l){if(f["default"].shinyMode){var r=l.target.getLatLng?l.target.getLatLng():l.latlng;if(r){var i=c["default"].latLng(r);r={lat:i.lat,lng:i.lng}}var s=u["default"].extend({id:t,".nonce":Math.random()},null!==o?{group:o}:null,r,a);d["default"].onInputChange(e+"_"+n,s)}}}function l(e){return e?"undefined"==typeof e.index?e:(e.data=(0,p.asArray)(e.data),e.index=(0,p.asArray)(e.index),u["default"].map(e.index,function(t){return e.data[t]})):e}function r(e,t,o,n,l,r){(function(){var e=this,i=this.layerManager.getLayer("cluster",l),s=null!==n;if(s&&!i){if(i=c["default"].markerClusterGroup.layerSupport(n),n.freezeAtZoom){var d=n.freezeAtZoom;delete n.freezeAtZoom,i.freezeAtZoom(d)}i.clusterLayerStore=new g["default"](i)}for(var f=s?{clusterId:l}:{},p=function(o){u["default"].isNumeric(t.get(o,"lat"))&&u["default"].isNumeric(t.get(o,"lng"))&&function(){var e=r(t,o),n=t.get(o,"layerId"),l=s?null:t.get(o,"group");s?i.clusterLayerStore.add(e,n):this.layerManager.addLayer(e,"marker",n,l,t.get(o,"ctGroup",!0),t.get(o,"ctKey",!0));var u=t.get(o,"popup"),c=t.get(o,"popupOptions");null!==u&&(null!==c?e.bindPopup(u,c):e.bindPopup(u));var d=t.get(o,"label"),p=t.get(o,"labelOptions");null!==d&&(null!==p?p.permanent?e.bindTooltip(d,p).openTooltip():e.bindTooltip(d,p):e.bindTooltip(d)),e.on("click",a(this.id,n,l,"marker_click",f),this),e.on("mouseover",a(this.id,n,l,"marker_mouseover",f),this),e.on("mouseout",a(this.id,n,l,"marker_mouseout",f),this),e.on("dragend",a(this.id,n,l,"marker_dragend",f),this)}.call(e)},y=0;y<t.nrow();y++)p(y);s&&this.layerManager.addLayer(i,"cluster",l,o)}).call(e)}function i(e,t,o,n){for(var l=function(l){(function(){var e=n(o,l);if(!u["default"].isEmptyObject(e)){var r=o.get(l,"layerId"),i=o.get(l,"group");if(this.layerManager.addLayer(e,t,r,i,o.get(l,"ctGroup",!0),o.get(l,"ctKey",!0)),e.bindPopup){var s=o.get(l,"popup"),c=o.get(l,"popupOptions");null!==s&&(null!==c?e.bindPopup(s,c):e.bindPopup(s))}if(e.bindTooltip){var d=o.get(l,"label"),f=o.get(l,"labelOptions");null!==d&&(null!==f?e.bindTooltip(d,f):e.bindTooltip(d))}e.on("click",a(this.id,r,i,t+"_click"),this),e.on("mouseover",a(this.id,r,i,t+"_mouseover"),this),e.on("mouseout",a(this.id,r,i,t+"_mouseout"),this);var p=o.get(l,"highlightOptions");if(!u["default"].isEmptyObject(p)){var y={};u["default"].each(p,function(e){"bringToFront"!=e&&"sendToBack"!=e&&o.get(l,e)&&(y[e]=o.get(l,e))}),e.on("mouseover",function(){this.setStyle(p),p.bringToFront&&this.bringToFront()}),e.on("mouseout",function(){this.setStyle(y),p.sendToBack&&this.bringToBack()})}}}).call(e)},r=0;r<o.nrow();r++)l(r)}function s(e){function t(t,o,n){o!==e.hasLayer(t)&&(o?(e.addLayer(t),e.fire("groupadd",{name:n,layer:t})):(e.removeLayer(t),e.fire("groupremove",{name:n,layer:t})))}function o(){if(e.layerManager){var o=e.getZoom();e.layerManager.getAllGroupNames().forEach(function(n){var a=e.layerManager.getLayerGroup(n,!1);a&&"undefined"!=typeof a.zoomLevels&&t(a,!0===a.zoomLevels||a.zoomLevels.indexOf(o)>=0,n)})}}e.leafletr._hasInitializedShowHideGroups||(e.leafletr._hasInitializedShowHideGroups=!0,e.showHideGroupsOnZoom=o,e.on("zoomend",o))}Object.defineProperty(o,"__esModule",{value:!0});var u=n(e("./global/jquery")),c=n(e("./global/leaflet")),d=n(e("./global/shiny")),f=n(e("./global/htmlwidgets")),p=e("./util"),y=e("./crs_utils"),h=n(e("./dataframe")),g=n(e("./cluster-layer-store")),m=n(e("./mipmapper")),v={};o["default"]=v,v.mouseHandler=a,v.clearGroup=function(e){var t=this;u["default"].each((0,p.asArray)(e),function(e,o){t.layerManager.clearGroup(o)})},v.setView=function(e,t,o){this.setView(e,t,o)},v.fitBounds=function(e,t,o,n,a){this.fitBounds([[e,t],[o,n]],a)},v.flyTo=function(e,t,o){this.flyTo(e,t,o)},v.flyToBounds=function(e,t,o,n,a){this.flyToBounds([[e,t],[o,n]],a)},v.setMaxBounds=function(e,t,o,n){this.setMaxBounds([[e,t],[o,n]])},v.addPopups=function(e,t,o,n,a,l){for(var r=this,i=(new h["default"]).col("lat",e).col("lng",t).col("popup",o).col("layerId",n).col("group",a).cbind(l),s=function(e){u["default"].isNumeric(i.get(e,"lat"))&&u["default"].isNumeric(i.get(e,"lng"))&&function(){var t=c["default"].popup(i.get(e)).setLatLng([i.get(e,"lat"),i.get(e,"lng")]).setContent(i.get(e,"popup")),o=i.get(e,"layerId"),n=i.get(e,"group");this.layerManager.addLayer(t,"popup",o,n)}.call(r)},d=0;d<i.nrow();d++)s(d)},v.removePopup=function(e){this.layerManager.removeLayer("popup",e)},v.clearPopups=function(){this.layerManager.clearLayers("popup")},v.addTiles=function(e,t,o,n){this.layerManager.addLayer(c["default"].tileLayer(e,n),"tile",t,o)},v.removeTiles=function(e){this.layerManager.removeLayer("tile",e)},v.clearTiles=function(){this.layerManager.clearLayers("tile")},v.addWMSTiles=function(e,t,o,n){n&&n.crs&&(n.crs=(0,y.getCRS)(n.crs)),this.layerManager.addLayer(c["default"].tileLayer.wms(e,n),"tile",t,o)},v.addGenericMarkers=r,v.addMarkers=function(e,t,o,n,a,i,s,d,f,p,y,g,m){var v,b;if(o&&(o.iconUrl=l(o.iconUrl),o.iconRetinaUrl=l(o.iconRetinaUrl),o.shadowUrl=l(o.shadowUrl),o.shadowRetinaUrl=l(o.shadowRetinaUrl),v=(new h["default"]).cbind(o),b=function(e){var t=v.get(e);return t.iconUrl?(t.iconWidth&&(t.iconSize=[t.iconWidth,t.iconHeight]),t.shadowWidth&&(t.shadowSize=[t.shadowWidth,t.shadowHeight]),t.iconAnchorX&&(t.iconAnchor=[t.iconAnchorX,t.iconAnchorY]),t.shadowAnchorX&&(t.shadowAnchor=[t.shadowAnchorX,t.shadowAnchorY]),t.popupAnchorX&&(t.popupAnchor=[t.popupAnchorX,t.popupAnchorY]),new c["default"].Icon(t)):new c["default"].Icon.Default}),!u["default"].isEmptyObject(e)&&!u["default"].isEmptyObject(t)||u["default"].isNumeric(e)&&u["default"].isNumeric(t)){var _=(new h["default"]).col("lat",e).col("lng",t).col("layerId",n).col("group",a).col("popup",s).col("popupOptions",d).col("label",y).col("labelOptions",g).cbind(i).cbind(m||{});o&&(v.effectiveLength=_.nrow()),r(this,_,a,f,p,function(e,t){var n=e.get(t);return o&&(n.icon=b(t)),c["default"].marker([e.get(t,"lat"),e.get(t,"lng")],n)})}},v.addAwesomeMarkers=function(e,t,o,n,a,l,i,s,d,f,p,y,g){var m,v;if(o&&(m=(new h["default"]).cbind(o),v=function(e){var t=m.get(e);return t?(t.squareMarker&&(t.className="awesome-marker awesome-marker-square"),new c["default"].AwesomeMarkers.icon(t)):new c["default"].AwesomeMarkers.icon}),!u["default"].isEmptyObject(e)&&!u["default"].isEmptyObject(t)||u["default"].isNumeric(e)&&u["default"].isNumeric(t)){var b=(new h["default"]).col("lat",e).col("lng",t).col("layerId",n).col("group",a).col("popup",i).col("popupOptions",s).col("label",p).col("labelOptions",y).cbind(l).cbind(g||{});o&&(m.effectiveLength=b.nrow()),r(this,b,a,d,f,function(e,t){var n=e.get(t);return o&&(n.icon=v(t)),c["default"].marker([e.get(t,"lat"),e.get(t,"lng")],n)})}},v.addGenericLayers=i,v.addCircles=function(e,t,o,n,a,l,r,s,d,f,p,y){(!u["default"].isEmptyObject(e)&&!u["default"].isEmptyObject(t)||u["default"].isNumeric(e)&&u["default"].isNumeric(t))&&i(this,"shape",(new h["default"]).col("lat",e).col("lng",t).col("radius",o).col("layerId",n).col("group",a).col("popup",r).col("popupOptions",s).col("label",d).col("labelOptions",f).col("highlightOptions",p).cbind(l).cbind(y||{}),function(e,t){return u["default"].isNumeric(e.get(t,"lat"))&&u["default"].isNumeric(e.get(t,"lng"))&&u["default"].isNumeric(e.get(t,"radius"))?c["default"].circle([e.get(t,"lat"),e.get(t,"lng")],e.get(t,"radius"),e.get(t)):null})},v.addCircleMarkers=function(e,t,o,n,a,l,i,s,d,f,p,y,g){(!u["default"].isEmptyObject(e)&&!u["default"].isEmptyObject(t)||u["default"].isNumeric(e)&&u["default"].isNumeric(t))&&r(this,(new h["default"]).col("lat",e).col("lng",t).col("radius",o).col("layerId",n).col("group",a).col("popup",d).col("popupOptions",f).col("label",p).col("labelOptions",y).cbind(g||{}).cbind(l),a,i,s,function(e,t){return c["default"].circleMarker([e.get(t,"lat"),e.get(t,"lng")],e.get(t))})},v.addPolylines=function(e,t,o,n,a,l,r,s,u){e.length>0&&i(this,"shape",(new h["default"]).col("shapes",e).col("layerId",t).col("group",o).col("popup",a).col("popupOptions",l).col("label",r).col("labelOptions",s).col("highlightOptions",u).cbind(n),function(e,t){var o=e.get(t,"shapes");return(o=o.map(function(e){return f["default"].dataframeToD3(e[0])})).length>1?c["default"].polyline(o,e.get(t)):c["default"].polyline(o[0],e.get(t))})},v.removeMarker=function(e){this.layerManager.removeLayer("marker",e)},v.clearMarkers=function(){this.layerManager.clearLayers("marker")},v.removeMarkerCluster=function(e){this.layerManager.removeLayer("cluster",e)},v.removeMarkerFromCluster=function(e,t){var o=this.layerManager.getLayer("cluster",t);o&&o.clusterLayerStore.remove(e)},v.clearMarkerClusters=function(){this.layerManager.clearLayers("cluster")},v.removeShape=function(e){this.layerManager.removeLayer("shape",e)},v.clearShapes=function(){this.layerManager.clearLayers("shape")},v.addRectangles=function(e,t,o,n,a,l,r,s,d,f,p,y){i(this,"shape",(new h["default"]).col("lat1",e).col("lng1",t).col("lat2",o).col("lng2",n).col("layerId",a).col("group",l).col("popup",s).col("popupOptions",d).col("label",f).col("labelOptions",p).col("highlightOptions",y).cbind(r),function(e,t){return u["default"].isNumeric(e.get(t,"lat1"))&&u["default"].isNumeric(e.get(t,"lng1"))&&u["default"].isNumeric(e.get(t,"lat2"))&&u["default"].isNumeric(e.get(t,"lng2"))?c["default"].rectangle([[e.get(t,"lat1"),e.get(t,"lng1")],[e.get(t,"lat2"),e.get(t,"lng2")]],e.get(t)):null})},v.addPolygons=function(e,t,o,n,a,l,r,s,u){e.length>0&&i(this,"shape",(new h["default"]).col("shapes",e).col("layerId",t).col("group",o).col("popup",a).col("popupOptions",l).col("label",r).col("labelOptions",s).col("highlightOptions",u).cbind(n),function(e,t){var o=e.get(t,"shapes").map(function(e){return e.map(f["default"].dataframeToD3)}).reduce(function(e,t){return e.concat(t)},[]);return c["default"].polygon(o,e.get(t))})},v.addGeoJSON=function(e,t,o,n){var l=this;"string"==typeof e&&(e=JSON.parse(e));var r=u["default"].extend({},n,e.style||{}),i=c["default"].geoJson(e,{style:function(e){return e.style||e.properties.style?u["default"].extend({},r,e.style,e.properties.style):r},onEachFeature:function(e,n){var r={featureId:e.id,properties:e.properties},i=e.properties?e.properties.popup:null;null!=i&&n.bindPopup(i),n.on("click",a(l.id,t,o,"geojson_click",r),this),n.on("mouseover",a(l.id,t,o,"geojson_mouseover",r),this),n.on("mouseout",a(l.id,t,o,"geojson_mouseout",r),this)}});this.layerManager.addLayer(i,"geojson",t,o)},v.removeGeoJSON=function(e){this.layerManager.removeLayer("geojson",e)},v.clearGeoJSON=function(){this.layerManager.clearLayers("geojson")},v.addTopoJSON=function(e,o,n,l){var r=this;"string"==typeof e&&(e=JSON.parse(e));var i=u["default"].extend({},l,e.style||{}),s=c["default"].geoJson(null,{style:function(e){return e.style||e.properties.style?u["default"].extend({},i,e.style,e.properties.style):i},onEachFeature:function(e,t){var l={featureId:e.id,properties:e.properties},i=e.properties.popup;null!=i&&t.bindPopup(i),t.on("click",a(r.id,o,n,"topojson_click",l),this),t.on("mouseover",a(r.id,o,n,"topojson_mouseover",l),this),t.on("mouseout",a(r.id,o,n,"topojson_mouseout",l),this)}});t.omnivore.topojson.parse(e,null,s),this.layerManager.addLayer(s,"topojson",o,n)},v.removeTopoJSON=function(e){this.layerManager.removeLayer("topojson",e)},v.clearTopoJSON=function(){this.layerManager.clearLayers("topojson")},v.addControl=function(e,t,o,n){function a(){var t=c["default"].DomUtil.create("div",n);return null!=o&&t.setAttribute("id",o),this._div=t,window.Shiny&&d["default"].initializeInputs?(d["default"].renderHtml(e,this._div),d["default"].initializeInputs(this._div),d["default"].bindAll(this._div)):this._div.innerHTML=e,this._div}function l(){window.Shiny&&d["default"].unbindAll&&d["default"].unbindAll(this._div)}var r=c["default"].Control.extend({options:{position:t},onAdd:a,onRemove:l});this.controls.add(new r,o,e)},v.addCustomControl=function(e,t){this.controls.add(e,t)},v.removeControl=function(e){this.controls.remove(e)},v.getControl=function(e){this.controls.get(e)},v.clearControls=function(){this.controls.clear()},v.addLegend=function(e){var t,o=c["default"].control({position:e.position});if(o.onAdd=function(){var o=c["default"].DomUtil.create("div",e.className),n=e.colors,a=e.labels,l="";if("numeric"===e.type){var r=20,i=8,s=4,d=6,f=(e.extra.p_n-e.extra.p_1)/(a.length-1),p=1/f*r+1,y=r/f*e.extra.p_1;t=(0,u["default"])("<span/>").css({background:"linear-gradient("+n+")",opacity:e.opacity,height:p+"px",width:"18px",display:"block","margin-top":i+"px"});var h=(0,u["default"])("<div/>").css("float","left"),g=(0,u["default"])("<div/>").css("float","left");h.append(t),(0,u["default"])(o).append(h).append(g).append((0,u["default"])("<br>")),document.body.appendChild(o);var m="http://www.w3.org/2000/svg",v=document.createElementNS(m,"svg");g.append(v);var b=document.createElementNS(m,"g");(0,u["default"])(b).attr("transform","translate(0, "+i+")"),v.appendChild(b);var _=0;u["default"].each(a,function(e){var t=y+e*r+.5,o=document.createElementNS(m,"text");(0,u["default"])(o).text(a[e]).attr("y",t).attr("dx",d).attr("dy","0.5ex"),b.appendChild(o),_=Math.max(_,o.getComputedTextLength());var n=document.createElementNS(m,"line");(0,u["default"])(n).attr("x1",0).attr("x2",s).attr("y1",t).attr("y2",t).attr("stroke-width",1),b.appendChild(n)}),(0,u["default"])(v).find("text").attr("dx",d+_).attr("text-anchor","end"),(0,u["default"])(v).css({width:_+d+"px",height:p+2*i+"px"}),e.na_color&&u["default"].inArray(e.na_label,a)<0&&(0,
u["default"])(o).append('<div><i style="background:'+e.na_color+";opacity:"+e.opacity+";margin-right:"+d+'px;"></i>'+e.na_label+"</div>")}else{e.na_color&&u["default"].inArray(e.na_label,a)<0&&(n.push(e.na_color),a.push(e.na_label));for(var w=0;w<n.length;w++)l+='<i style="background:'+n[w]+";opacity:"+e.opacity+'"></i> '+a[w]+"<br>";o.innerHTML=l}return e.title&&(0,u["default"])(o).prepend('<div style="margin-bottom:3px"><strong>'+e.title+"</strong></div>"),o},e.group){e.layerId||(e.layerId=c["default"].Util.stamp(o));var n=this;n.on("overlayadd",function(t){t.name===e.group&&n.controls.add(o,e.layerId)}),n.on("overlayremove",function(t){t.name===e.group&&n.controls.remove(e.layerId)}),n.on("groupadd",function(t){t.name===e.group&&n.controls.add(o,e.layerId)}),n.on("groupremove",function(t){t.name===e.group&&n.controls.remove(e.layerId)})}this.controls.add(o,e.layerId)},v.addLayersControl=function(e,t,o){var n=this;v.removeLayersControl.call(this);var a=!0,l={};u["default"].each((0,p.asArray)(e),function(e,t){var o=n.layerManager.getLayerGroup(t,!0);o&&(l[t]=o,n.hasLayer(o)&&(a?a=!1:n.removeLayer(o)))});var r={};u["default"].each((0,p.asArray)(t),function(e,t){var o=n.layerManager.getLayerGroup(t,!0);o&&(r[t]=o)}),this.currentLayersControl=c["default"].control.layers(l,r,o),this.addControl(this.currentLayersControl)},v.removeLayersControl=function(){this.currentLayersControl&&(this.removeControl(this.currentLayersControl),this.currentLayersControl=null)},v.addScaleBar=function(e){v.removeScaleBar.call(this);var t=c["default"].control.scale(e).addTo(this);this.currentScaleBar=t},v.removeScaleBar=function(){this.currentScaleBar&&(this.currentScaleBar.remove(),this.currentScaleBar=null)},v.hideGroup=function(e){var t=this;u["default"].each((0,p.asArray)(e),function(e,o){var n=t.layerManager.getLayerGroup(o,!0);n&&t.removeLayer(n)})},v.showGroup=function(e){var t=this;u["default"].each((0,p.asArray)(e),function(e,o){var n=t.layerManager.getLayerGroup(o,!0);n&&t.addLayer(n)})},v.setGroupOptions=function(e,t){var o=this;u["default"].each((0,p.asArray)(e),function(e,n){var a=o.layerManager.getLayerGroup(n,!0);"undefined"!=typeof t.zoomLevels&&null!==t.zoomLevels&&(a.zoomLevels=(0,p.asArray)(t.zoomLevels))}),s(this),this.showHideGroupsOnZoom()},v.addRasterImage=function(e,t,o,n,a){function l(e,t,o){var n=e*Math.PI/180,a=Math.pow(2,o);return{x:(t+180)/360*a,y:(1-Math.log(Math.tan(n)+1/Math.cos(n))/Math.PI)/2*a}}function r(e,t,o,n){return 3==arguments.length&&(n=o),o<t&&n>=e}function i(e){for(var t=["imageSmoothingEnabled","mozImageSmoothingEnabled","webkitImageSmoothingEnabled","msImageSmoothingEnabled"],o=0;o<t.length;o++)if("undefined"!=typeof e[t[o]])return t[o];return null}function s(e){null!=u?setTimeout(function(){e(u,f,p,d)},0):y.push(e)}var u=null,d=null,f=null,p=null,y=[],h=new Image;h.onload=function(){f=h.width,p=h.height;var e=document.createElement("canvas");e.width=f,e.height=p,e.style.display="none",document.body.appendChild(e);var t=e.getContext("2d");t.drawImage(h,0,0),u=t.getImageData(0,0,f,p).data,d=new m["default"](h),document.body.removeChild(e);for(var o=0;o<y.length;o++)y[o](u,f,p,d);y=[]},h.src=e;var g=c["default"].gridLayer(Object.assign({},a,{detectRetina:!0,async:!0}));g.createTile=function(e,o){var n,a=e.z,u=c["default"].DomUtil.create("canvas"),d=this.getTileSize();return u.width=d.x,u.height=d.y,s(function(s,c,d,f){try{var p=u.getContext("2d"),y=l(t[0][0],t[0][1],a),h=l(t[1][0],t[1][1],a),g={x:h.x-y.x,y:h.y-y.y};if(!r(e.x,e.x+1,y.x,h.x))return;if(!r(e.y,e.y+1,y.y,h.y))return;var m={x:c/g.x,y:d/g.y},v=i(p);if(v||m.x>=256&&m.y>=256)v&&(p[v]=m.x>=256&&m.y>=256),f.getBySize(256*g.x,256*g.y,function(t){p.drawImage(t,256*(y.x-e.x),256*(y.y-e.y),256*g.x,256*g.y)});else for(var b={x:Math.max(0,Math.floor((e.x-y.x)*m.x)),y:Math.max(0,Math.floor((e.y-y.y)*m.y))},_={x:Math.min(c,Math.ceil((e.x+1-y.x)*m.x)),y:Math.min(d,Math.ceil((e.y+1-y.y)*m.y))},w={x:256/m.x,y:256/m.y},L=b.y;L<_.y;L++)for(var M=b.x;M<_.x;M++){var C=4*(L*c+M),k=s[C],x=s[C+1],S=s[C+2],O=s[C+3];p.fillStyle="rgba("+[k,x,S,O/255].join(",")+")";var I={x:256*(M/m.x+y.x-e.x),y:256*(L/m.y+y.y-e.y)};p.fillRect(Math.round(I.x),Math.round(I.y),Math.round(I.x+w.x)-Math.round(I.x),Math.round(I.y+w.y)-Math.round(I.y))}}catch(T){n=T}finally{o(n,u)}}),u},this.layerManager.addLayer(g,"image",o,n)},v.removeImage=function(e){this.layerManager.removeLayer("image",e)},v.clearImages=function(){this.layerManager.clearLayers("image")},v.addMeasure=function(e){v.removeMeasure.call(this),this.measureControl=c["default"].control.measure(e),this.addControl(this.measureControl)},v.removeMeasure=function(){this.measureControl&&(this.removeControl(this.measureControl),this.measureControl=null)},v.addSelect=function(e){var o=this;v.removeSelect.call(this),this._selectButton=c["default"].easyButton({states:[{stateName:"select-inactive",icon:"ion-qr-scanner",title:"Make a selection",onClick:function(n,a){if(n.state("select-active"),o._locationFilter=new c["default"].LocationFilter2,e){var l=new t.crosstalk.SelectionHandle(e);l.on("change",function(e){e.sender!==l&&o._locationFilter&&(o._locationFilter.disable(),n.state("select-inactive"))});var r=function(){o.layerManager.brush(o._locationFilter.getBounds(),{sender:l})};o._locationFilter.on("enabled",r),o._locationFilter.on("change",r),o._locationFilter.on("disabled",function(){l.close(),o._locationFilter=null})}o._locationFilter.addTo(a)}},{stateName:"select-active",icon:"ion-close-round",title:"Dismiss selection",onClick:function(e){e.state("select-inactive"),o._locationFilter.disable(),o.layerManager.unbrush()}}]}),this._selectButton.addTo(this)},v.removeSelect=function(){this._locationFilter&&this._locationFilter.disable(),this._selectButton&&(this.removeControl(this._selectButton),this._selectButton=null)},v.createMapPane=function(e,t){this.createPane(e),this.getPane(e).style.zIndex=t}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./cluster-layer-store":1,"./crs_utils":3,"./dataframe":4,"./global/htmlwidgets":8,"./global/jquery":9,"./global/leaflet":10,"./global/shiny":12,"./mipmapper":16,"./util":17}],16:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(t){n(this,e),this._layers=[t]}return l(e,[{key:"getBySize",value:function(e,t,o){var n=this,a=0,l=this._layers[0];(function r(){n.getByIndex(a,function(n){return!n||n.width<e||n.height<t?void o(l):(l=n,a++,void r())})})()}},{key:"getByIndex",value:function(e,t){var o=this;this._layers[e]?t(this._layers[e]):this.getByIndex(e-1,function(n){n?n.width<2||n.height<2?t(null):o.reduce(n,function(n){o._layers[e]=n,t(n)}):t(null)})}},{key:"reduce",value:function(e,t){var o=document.createElement("canvas");o.width=Math.ceil(e.width/2),o.height=Math.ceil(e.height/2),o.style.display="none",document.body.appendChild(o);try{o.getContext("2d").drawImage(e,0,0,e.width/2,e.height/2),t(o)}finally{document.body.removeChild(o)}}}]),e}();o["default"]=r},{}],17:[function(e,t,o){"use strict";function n(e){console&&console.log&&console.log(e)}function a(e,t,o){if(0===t&&!o)return[];if(!(e instanceof Array)){if(o)throw new Error("Can't do in-place recycling of a non-Array value");e=[e]}void 0===t&&(t=e.length);for(var n=o?e:[],a=e.length;n.length<t;)n.push(e[n.length%a]);return n.length>t&&n.splice(t,n.length-t),n}function l(e){return e instanceof Array?e:[e]}Object.defineProperty(o,"__esModule",{value:!0}),o.log=n,o.recycle=a,o.asArray=l},{}]},{},[13]);