!function(t){var e,o;if("function"==typeof define&&define.amd)define(["leaflet","proj4"],t);else if("object"==typeof module&&"object"==typeof module.exports)e=require("leaflet"),o=require("proj4"),module.exports=t(e,o);else{if("undefined"==typeof window.L||"undefined"==typeof window.proj4)throw"Leaflet and proj4 must be loaded first";t(window.L,window.proj4)}}(function(t,e){return e.__esModule&&e["default"]&&(e=e["default"]),t.Proj={},t.Proj._isProj4Obj=function(t){return"undefined"!=typeof t.inverse&&"undefined"!=typeof t.forward},t.Proj.Projection=t.Class.extend({initialize:function(e,o,i){var n=t.Proj._isProj4Obj(e);this._proj=n?e:this._projFromCodeDef(e,o),this.bounds=n?o:i},project:function(e){var o=this._proj.forward([e.lng,e.lat]);return new t.Point(o[0],o[1])},unproject:function(e,o){var i=this._proj.inverse([e.x,e.y]);return new t.LatLng(i[1],i[0],o)},_projFromCodeDef:function(t,o){if(o)e.defs(t,o);else if(e.defs[t]===undefined){var i=t.split(":");if(i.length>3&&(t=i[i.length-3]+":"+i[i.length-1]),e.defs[t]===undefined)throw"No projection definition for code "+t}return e(t)}}),t.Proj.CRS=t.Class.extend({includes:t.CRS,options:{transformation:new t.Transformation(1,0,-1,0)},initialize:function(e,o,i){var n,s,r,a;if(t.Proj._isProj4Obj(e)?(n=(s=e).srsCode,a=o||{},this.projection=new t.Proj.Projection(s,a.bounds)):(n=e,r=o,a=i||{},this.projection=new t.Proj.Projection(n,r,a.bounds)),t.Util.setOptions(this,a),this.code=n,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new t.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var l=this.options.resolutions.length-1;l>=0;l--)this.options.resolutions[l]&&(this._scales[l]=1/this.options.resolutions[l])}this.infinite=!this.options.bounds},scale:function(t){var e,o=Math.floor(t);return t===o?this._scales[t]:(e=this._scales[o])+(this._scales[o+1]-e)*(t-o)},zoom:function(t){var e,o,i=this._closestElement(this._scales,t),n=this._scales.indexOf(i);return t===i?n:i===undefined?-Infinity:(o=n+1,(e=this._scales[o])===undefined?Infinity:(t-i)/(e-i)+n)},distance:t.CRS.Earth.distance,R:t.CRS.Earth.R,_closestElement:function(t,e){for(var o,i=t.length;i--;)t[i]<=e&&(o===undefined||o<t[i])&&(o=t[i]);return o}}),t.Proj.GeoJSON=t.GeoJSON.extend({initialize:function(e,o){this._callLevel=0,t.GeoJSON.prototype.initialize.call(this,e,o)},addData:function(e){var o;e&&(e.crs&&"name"===e.crs.type?o=new t.Proj.CRS(e.crs.properties.name):e.crs&&e.crs.type&&(o=new t.Proj.CRS(e.crs.type+":"+e.crs.properties.code)),o!==undefined&&(this.options.coordsToLatLng=function(e){var i=t.point(e[0],e[1]);return o.projection.unproject(i)})),this._callLevel++;try{t.GeoJSON.prototype.addData.call(this,e)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}}),t.Proj.geoJson=function(e,o){return new t.Proj.GeoJSON(e,o)},t.Proj.ImageOverlay=t.ImageOverlay.extend({initialize:function(e,o,i){t.ImageOverlay.prototype.initialize.call(this,e,null,i),this._projectedBounds=o},_animateZoom:function(e){var o=this._map.getZoomScale(e.zoom),i=t.point(this._projectedBounds.min.x,this._projectedBounds.max.y),n=this._projectedToNewLayerPoint(i,e.zoom,e.center);t.DomUtil.setTransform(this._image,n,o)},_reset:function(){var e=this._map.getZoom(),o=this._map.getPixelOrigin(),i=t.bounds(this._transform(this._projectedBounds.min,e)._subtract(o),this._transform(this._projectedBounds.max,e)._subtract(o)),n=i.getSize();t.DomUtil.setPosition(this._image,i.min),this._image.style.width=n.x+"px",this._image.style.height=n.y+"px"},_projectedToNewLayerPoint:function(t,e,o){var i=this._map.getSize()._divideBy(2),n=this._map.project(o,e)._subtract(i)._round().add(this._map._getMapPanePos());return this._transform(t,e)._subtract(n)},_transform:function(t,e){var o=this._map.options.crs,i=o.transformation,n=o.scale(e);return i.transform(t,n)}}),t.Proj.imageOverlay=function(e,o,i){return new t.Proj.ImageOverlay(e,o,i)},t.Proj});